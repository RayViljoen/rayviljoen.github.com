<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>{{ page.title }}</title>
    {% if page.description %}<meta name="description" content="{{ page.description }}">{% endif %}
    <meta name="author" content="{{ site.author.name }}">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="{{ ASSET_PATH }}/css/1.4.0/bootstrap.css" rel="stylesheet">
    <link href="{{ ASSET_PATH }}/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">

    <!-- Le web fonts -->
    <link href='http://fonts.googleapis.com/css?family=Lobster' rel='stylesheet' type='text/css'>

    <!-- Le fav and touch icons -->
  <!-- Update these with your own images
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
  -->
  </head>

  <body>

    <div class="topbar">
      <div class="fill">
        <div class="container">
          <a class="brand" href="{{ HOME_PATH }}">{{ site.title }}</a>
          <ul class="nav">
            {% assign pages_list = site.pages %}
            {% assign group = 'navigation' %}
            {% include JB/pages_list %}
          </ul>

        </div>
      </div>
    </div>

    <div class="container">

      <div class="content">
        {{ content }}
      </div>

      <footer>
        <p>&copy; {{ site.author.name }} 2012 
          with help from <a href="http://jekyllbootstrap.com" target="_blank" title="The Definitive Jekyll Blogging Framework">Jekyll Bootstrap</a>
          and <a href="http://twitter.github.com/bootstrap/" target="_blank">Twitter Bootstrap</a>
        </p>
      </footer>

    </div> <!-- /container -->
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script type="text/javascript" >

        // Parse search results after render
        $(window).load(function(){

            "use strict";

            // Create array containing post data for search function
            var searchDB = {

                // --------------------------------liquid-------------------------------------
                {% for post in site.posts %}
                  '{{ post.title }}' : {

                    url: '{{ post.url }}',

                    // Add all possible post info to string for searching
                    content: 'Title: {{ post.title }} | Category: {{ post.category }} | Tags: {{ post.tags }} | Content: {{ post.content | strip_html | strip_newlines }}',
                  },
                {% endfor %}
                // --------------------------------liquid-------------------------------------

            };

            // Search Events
            $('#search input').on({

                // User types into search input
                keyup: function(){
              
                    var searchValue, searchRegex, resultContainer;

                    // Empty search every time
                    $('#search ul li').empty();
                    
                    // Dynamic Result Container
                    resultContainer = $('#search ul');

                    // Search value & regex
                    searchValue = $(this).val();
                    searchRegex = new RegExp(searchValue, 'gi');

                    // Perform regex if search is not blank
                    if(searchValue){

                        // Itterate posts and match search term
                        $.each(searchDB, function(k,v){

                            // Add post link to dropdown in case of match
                            if(v.content.match(searchRegex)){
                                resultContainer.prepend('<li><a href="' + v.url + '">' + k + '</a></li>');
                            }
                        });
                    }
                },

                // Show results on focus
                focus: function(){
                    $('#search ul').fadeIn(200);
                },

                // Hide on blur
                blur: function(){
                    $('#search ul').fadeOut(200);
                }
            });

        });

    </script>

    {% include JB/analytics %}

  </body>
</html>
